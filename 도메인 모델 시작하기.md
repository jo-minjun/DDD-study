# 1. 도메인 모델 시작하기

## 1. 도메인이란?

- 개발자 입장에서 온라인 서점은 구현해야 할 소프트웨어의 대상이다. 온라인 서점은 상품 조회, 구매, 결제, 배송 추척 등의 기능을 제공해야 한다. 이때 온라인 서점은 해결하고자 하는 문제 영역, 즉 도메인에 해당한다.
- 한 도메인은 다시 하위 도메인으로 나눌 수 있다.
  ![1.png](./img/1.png)
  - 온라인 서점 도메인은 위 그림과 같이 몇 개의 하위 도메인으로 나눌 수 있다.
  - 카탈로그 하위 도메인: 상품 목록 제공
  - 주문 하위 도메인: 고객의 주문 처리
  - 혜택 하위 도메인: 쿠폰이나 특별할인과 같은 서비스 제공
  - 배송 하위 도메인: 구매한 상품을 전달하는 일련의 과정
  - 한 하위 도메인은 다른 하위 도메인과 연동하여 완전한 기능을 제공한다.
    - 고객이 물건을 구매하면 주문, 결제, 배송, 혜택 하위 도메인의 기능이 엮인다.
- 특정 도메인을 위한 소프트웨어라고 해서 도메인이 제공해야 할 모든 기능을 직접 구현하는 것은 아니다.
  - 일부 기능은 자체 시스템으로 구현하고, 나머지 기능은 외부 업체의 시스템을 사용한다.
    ![2.png](./img/2.png)
- 도메인마다 고정된 하위 도메인이 존재하는 것은 아니다.
  - 모든 온라인 쇼핑몰이 혜택을 제공하는 것은 아니다.
  - 소규모 쇼핑몰은 엑셀을 이용해서 수작업으로 정산을 처리한다.
- 하위 도메인을 어떻게 구성할지는 상황에 따라 달라진다.
  - 기업 고객을 대상으로 대형 장비를 판매하는 곳은 온라인으로 카탈로그를 제공하는 주문서를 받는 정도만 필요하며, 온라인 결제나 배송 추적과 같은 기능을 제공할 필요가 없다.
  - 일반 고객을 대상으로 물건을 판매한다면 카탈로그, 리뷰, 주문, 결제, 배송, 회원 기능 등이 필요하다.

## 2. 도메인 전문가와 개발자 간 지식 공유

- 온라인 홍보, 정산, 배송 등 각 영역에는 전문가가 있다. 이들은 지식과 경험을 바탕으로 본인들이 원하는 기능 개발을 요구한다.
  - 회계 담당자는 엑셀로 맞추던 정산 금액 계산을 자동화해 주는 기능을 요구할 수 있다.
- 개발자는 요구사항을 분석하고 설계하여 코드를 작성하며 테스트하고 배포한다. 이 과정에서 요구사항은 첫 단추와 같다. 첫 단추를 잘못 끼우면 모든 단추가 잘못 끼워진다.
- 도메인 전문가 만큼은 아니겠지만 이해관계자와 개발자도 도메인 지식을 갖춰야 한다. 도메인 전문가, 관계자, 개발자가 같은 지식을 공유하고 직접 소통할수록 도메인 전문가가 원하는 제품을 만들 가능성이 높아진다.

## 3. 도메인 모델

- 도메인 모델은 특정 도메인을 개념적으로 표현한 것이다.
- 주문 도메인을 생각해보자.
  - 상품을 몇개 살지 선택하고 배송지를 입력한다.
  - 선택한 상품 가격을 이용해서 총 지불 금액을 계산한다.
  - 금액 지불을 위한 결제 수단을 선택한다.
  - 주문한 뒤에도 배송 전이면 배송지 주소를 변경하거나 주문을 취소할 수 있다.
- 객체 기반 주문 도메인 모델
  ![3.png](./img/3.png)
  - 도메인의 모든 내용을 담고 있지는 않지만 주문(Order), 주문번호(orderNumber)와 지불할 총금액(totalAmounts)이 있고, 배송정보(ShippingInfo)를 변경할 수 있음을 알 수 있다.
  - 도메인을 이해하려면 도메인이 제공하는 기능과 주요 데이터 구성을 파악해야 하는데, 기능과 데이터를 함께 보여주는 객체 모델은 도메인을 모델링하기에 적합하다.
- 상태 다이어그램 기반 주문 상태 모델
  ![4.png](./img/4.png)
  - 이 다이어그램을 보면 상품 준비 중 상태에서 주문을 취소하면 결제 취소가 함께 이루어진다는 것을 알 수 있다.
- 도메인 모델을 표현할 때 UML 표기법만 사용해야 하는 것은 아니다. 도메인을 이해하는 데 도움이 된다면 표현 방식이 무엇인지는 중요하지 않다.
  - 관계가 중요한 경우: 그래프로 모델링
  - 계산 규칙이 중요한 경우: 수학 공식을 활용해서 모델링
- 도메인 모델은 도메인 자체를 이해하기 위한 개념 모델이다.
- 개념 모델을 이용해서 바로 코드를 작성할 수 있는 것은 아니기에 구현 모델이 따로 필요하다. 하지만 구현 모델이 개념 모델을 최대한 따르도록 할 수는 있다.
  - 객체 기반 모델 개념 모델: 객체 지향 언어를 이용해서 유사한 구현 모델을 만든다.
  - 수학적 모델 기반 개념 모델: 함수를 이용해서 유사한 구현 모델을 만든다.

### 하위 도메인과 모델

- 상술했듯 도메인은 다수의 하위 도메인으로 구성된다.
- 각 하위 도메인이 다루는 영역은 서로 다르기 때문에 같은 용어라도 하위 도메인마다 의미가 달라질 수 있다.
  - 카탈로그 도메인의 상품: 상품 가격, 상세 내용을 담고 있는 정보
  - 배송 도메인의 상품: 고객에게 실제 배송되는 물리적인 상품
- 도메인에 따라 용어의 의미가 결정되므로 여러 하위 도메인을 하나의 다이어그램에 모델링하면 안된다. 즉, 카탈로그 도메인과 배송 도메인은 모델을 따로 만들어야 한다.
- 모델의 각 구성요소는 특정 도메인으로 한정할 때 비로소 의미가 완전해진다.
